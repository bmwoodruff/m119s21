---
title: "Class Example Task 1"
author: "Ben Woodruff"
date: "5/4/2021"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Background

In here we'll put some background information. Grabbing it from online works.  

## Task 1
This code creates a data frame called “dist”. The dist data frame contains measurements for 202 light bulbs 2104 hours after the the light bulb was turned on.

```{r}
library(data4led)
dist <- led_time(2100)
```

The data frame named “dist” includes the columns (1) “id”, the identification number for your randomly selected bulb, (2) “hours”, the number of hours since the bulb has turned on, (3) “intensity”, the lumen output of the bulb, and (4) “percent_intensity”, the bulb intensity as a percent of the original lumen.

The histogram below shows the distribution of the "percent intensity" column. 

```{r}
hist(dist$percent_intensity,xlab='Percent Intensity',ylab='Count',main='Histogram of Percent Intensity', probability=TRUE)
```

From the histogram above, we can see that the percent intensities of the bulbs appear to follow some bell shaped distribution.  The center of this bell is around 101.5%.  

## Task 2

We will be exploring the following models. 

1. $f_0(L; a,b) = \frac{1}{b-a}$ with $-\infty < a < L < b < \infty$ (and 0 otherwise)
2. $f_1(L; h,a) = \frac{1}{\sqrt{2\pi a}}e^{-\frac{(x-h)^2}{2a}}$ with $h>0$, $a>0$, and $−\infty<L<\infty$
3. $f_2(L; h,a,b) = \frac{b^a}{\Gamma(a)}(L-h)^{a-1}e^{-b(L-h)}$ with $a>0$, $b>0$, and $L\geq h$ (and 0 otherwise)

Let's examine the first model, $f_0$. 
The variable $a$ controls the starting point of the domain of the function, and similarly $b$ is the end point.  The function is constant.  Let's plot a couple representatives below. 

```{r}
f0 <- function(L,a=0,b=1){
  # Make sure a < b when using this function.
  
  out <- rep(-1,length(L))
  out[(L <= a)] <- 0
  out[(a < L) & (L < b)] <- 1/(b-a) + 0*L[(a < L) & (L < b)]
  out[(L >=b)] <-0
  
  return(out)
}

b <- 102
a1 <- 97
L1 <- seq(a1,b,0.1)
y1 <- f0(L1,a1,b)

par(mfrow=c(1,2),mar=c(2.5,2.5,1,0.25))
plot(L1,y1,type='l',xlim=c(90,110), ylim=c(0,0.35))

a2 <- 99
L2 <- seq(a2,b,0.1)
y2 <- f0(L2,a2,b)

plot(L2,y2,type='l',xlim=c(90,110), ylim=c(0,0.35))
mtext('Changing a in f0', side = 3, line = 0)

```

In the two plots above we chose $b=102$, and changed $a$ from 97 to 99.  Making $a$ closer to $b$ causes the graph to be narrow and higher.   We can similarly see what happens as we change $b$, which we will do in the plots below. 

```{r}
b1 <- 102
a <- 97
L1 <- seq(a,b1,0.1)
y1 <- f0(L1,a,b1)

par(mfrow=c(1,2),mar=c(2.5,2.5,1,0.25))
plot(L1,y1,type='l',xlim=c(90,110), ylim=c(0,0.25))

b2 <- 109
L2 <- seq(a,b2,0.1)
y2 <- f0(L2,a,b2)

plot(L2,y2,type='l',xlim=c(90,110), ylim=c(0,0.25))
mtext('Changing a in f0', side = 3, line = 0)

```
In the plot above we fixed $a=97$ and then changed $b$ from 102 to 109.  Increasing $b$ caused the graph to be wider and shorter. 

